function calendarJs(ge,he,ie){function F(a,d){q=h(a)?a:new Date;q.setDate(1);q.setHours(0,0,0,0);var b=q,e=new Date;$c=b.getFullYear()===e.getFullYear()&&b.getMonth()===e.getMonth();d=h(d)?d:!1;e=(new Date(q.getFullYear(),q.getMonth(),1)).getDay();b=Ib(q.getFullYear(),q.getMonth());0===e&&(e=7);xa();if(!Jb){x=ya(ad);x.className="calendar";x.innerHTML="";je();ke();le();me();var f=g("div","row header-days"),k=c.dayHeaderNames.length;x.appendChild(f);for(var l=0;l<k;l++){var m=c.dayHeaderNames[l],n=
    g("div","cell");n.innerText=m;f.appendChild(n)}for(f=0;6>f;f++)for(k=g("div","row"),x.appendChild(k),l=0;7>l;l++)m=7*f+(l+1),n=g("div","cell"),n.id="calendar-day-"+m,k.appendChild(n),0<c.minimumDayHeight&&(n.style.height=c.minimumDayHeight+"px");bd||(p.body.addEventListener("click",xa),p.body.addEventListener("contextmenu",xa),za.addEventListener("resize",xa),za.addEventListener("resize",cd),p.addEventListener("keydown",ne),bd=!0);Jb=!0}m=e;if(1<m)for(f=new Date(q),f.setMonth(f.getMonth()-1),k=Ib(f.getFullYear(),
    f.getMonth()),l=1,m=k-m+1;m<k;m++)oc(m+1,l,f.getMonth(),f.getFullYear(),!0),l++;for(k=f=0;k<b;k++)f=e+k,oc(k+1,f,q.getMonth(),q.getFullYear(),!1);if(42>f){e=1;b=new Date(q);b.setMonth(b.getMonth()+1);for(f+=1;43>f;f++)oc(e,f,b.getMonth(),b.getFullYear(),!0),e++;e=Ib(b.getFullYear(),b.getMonth());e=Math.round(e/2);pc=new Date(b.getFullYear(),b.getMonth(),e)}else pc=null;ea();d&&(null===T&&(T=g("div","disabled-background")),null!==Aa&&A(p.body,Aa),Aa=g("div","calendar-dialog event-editor"),p.body.appendChild(Aa),
    e=g("div","view"),Aa.appendChild(e),fa=g("div","disabled-area"),e.appendChild(fa),Kb=g("div","title-bar"),e.appendChild(Kb),b=g("div","contents"),e.appendChild(b),e=g("p"),e.innerText=c.titleText,b.appendChild(e),e=g("div","input-title-container"),b.appendChild(e),Ba=g("input",null,"text"),e.appendChild(Ba),f=g("input","select-colors","button"),f.value="...",f.onclick=oe,e.appendChild(f),e=g("p"),e.innerText=c.fromText.replace(":","")+"/"+c.toText,b.appendChild(e),e=g("div","split"),b.appendChild(e),
    N=g("input"),N.onchange=Lb,e.appendChild(N),ha(N,"date"),U=g("input"),e.appendChild(U),ha(U,"time"),e=g("div","split"),b.appendChild(e),G=g("input"),G.onchange=Lb,e.appendChild(G),ha(G,"date"),V=g("input"),e.appendChild(V),ha(V,"time"),gb=H(b,c.isAllDayText,Lb)[0],e=g("p"),e.innerText=c.repeatsText,b.appendChild(e),e=g("div","radioButtonsContainer"),b.appendChild(e),Ca=W(e,c.repeatsNever,"RepeatType",La),Mb=W(e,c.repeatsEveryDayText,"RepeatType",La),Nb=W(e,c.repeatsEveryWeekText,"RepeatType",La),
    Ob=W(e,c.repeatsEveryMonthText,"RepeatType",La),Pb=W(e,c.repeatsEveryYearText,"RepeatType",La),Ma=g("input","repeat-options","button"),Ma.value="...",Ma.onclick=pe,e.appendChild(Ma),e=g("p"),e.innerText=c.locationText,b.appendChild(e),hb=g("input",null,"text"),b.appendChild(hb),e=g("p"),e.innerText=c.descriptionText,b.appendChild(e),ib=g("textarea","custom-scroll-bars"),b.appendChild(ib),jb=g("p","error"),b.appendChild(jb),e=g("div","split"),b.appendChild(e),Na=g("input","ok","button"),Na.value=c.addText,
    Na.onclick=qe,e.appendChild(Na),f=g("input","cancel","button"),f.value=c.cancelText,f.onclick=qc,e.appendChild(f),Oa=g("input","remove","button"),Oa.value=c.removeEventText,Oa.onclick=re,b.appendChild(Oa),null!==ia&&A(p.body,ia),ia=g("div","calendar-dialog event-editor-colors"),p.body.appendChild(ia),b=g("div","title-bar"),b.innerText=c.selectColorsText,ia.appendChild(b),b=g("div","contents"),ia.appendChild(b),e=g("p"),e.innerText=c.backgroundColorText,b.appendChild(e),Pa=g("input"),b.appendChild(Pa),
    ha(Pa,"color"),e=g("p"),e.innerText=c.textColorText,b.appendChild(e),Qa=g("input"),b.appendChild(Qa),ha(Qa,"color"),e=g("p"),e.innerText=c.borderColorText,b.appendChild(e),Ra=g("input"),b.appendChild(Ra),ha(Ra,"color"),e=g("div","split"),b.appendChild(e),b=g("input","ok","button"),b.value=c.okText,b.onclick=se,e.appendChild(b),b=g("input","cancel","button"),b.value=c.cancelText,b.onclick=dd,e.appendChild(b),null!==ja&&A(p.body,ja),ja=g("div","calendar-dialog event-editor-repeat-options"),p.body.appendChild(ja),
    b=g("div","title-bar"),b.innerText=c.repeatOptionsTitle,ja.appendChild(b),b=g("div","contents"),ja.appendChild(b),e=g("p"),e.innerText=c.daysToExcludeText,b.appendChild(e),Qb=H(b,c.dayNames[0])[0],Rb=H(b,c.dayNames[1])[0],Sb=H(b,c.dayNames[2])[0],Tb=H(b,c.dayNames[3])[0],Ub=H(b,c.dayNames[4])[0],Vb=H(b,c.dayNames[5])[0],Wb=H(b,c.dayNames[6])[0],e=g("p"),e.innerText=c.repeatEndsText,b.appendChild(e),Da=g("input"),b.appendChild(Da),ha(Da,"date"),e=g("div","split"),b.appendChild(e),b=g("input","ok",
    "button"),b.value=c.okText,b.onclick=te,e.appendChild(b),b=g("input","cancel","button"),b.value=c.cancelText,b.onclick=ed,e.appendChild(b),null!==ka&&A(p.body,ka),ka=g("div","calendar-dialog confirmation"),p.body.appendChild(ka),rc=g("div","title-bar"),ka.appendChild(rc),b=g("div","contents"),ka.appendChild(b),sc=g("div","message"),b.appendChild(sc),e=H(b,c.removeAllEventsInSeriesText),Xb=e[0],tc=e[1],e=g("div","split"),b.appendChild(e),kb=g("input","yes","button"),kb.value=c.yesText,e.appendChild(kb),
    lb=g("input","no","button"),lb.value=c.noText,e.appendChild(lb),null!==la&&A(p.body,la),la=g("div","calendar-dialog select-export-type"),p.body.appendChild(la),b=g("div","title-bar"),b.innerText=c.selectExportTypeTitle,la.appendChild(b),e=g("div","contents"),la.appendChild(e),b=g("div","radioButtonsContainer"),e.appendChild(b),uc=W(b,"CSV","ExportType"),fd=W(b,"XML","ExportType"),gd=W(b,"JSON","ExportType"),hd=W(b,"TEXT","ExportType"),id=W(b,"iCAL","ExportType"),b=g("div","split"),e.appendChild(b),
    e=g("input","ok","button"),e.value=c.okText,e.onclick=ue,b.appendChild(e),e=g("input","cancel","button"),e.value=c.cancelText,e.onclick=jd,b.appendChild(e),null!==z&&A(p.body,z),z=g("div","calendar-dialog search"),p.body.appendChild(z),b=g("div","title-bar"),b.innerText=c.searchEventsTitle,b.onmousedown=ve,b.onmouseup=we,z.appendChild(b),e=g("div","ib-close"),e.onclick=xe,b.appendChild(e),J(e,c.closeTooltipText),ma=g("div","ib-minus"),ma.onclick=kd,b.appendChild(ma),J(ma,c.minimizedTooltipText),K=
    g("div","contents"),z.appendChild(K),b=g("p"),b.innerText=c.forText,K.appendChild(b),X=g("input",null,"text"),X.oninput=na,X.onpropertychange=na,X.onkeypress=ye,K.appendChild(X),ld=H(K,c.matchCaseText,na)[0],b=g("p"),b.innerText=c.includeText,K.appendChild(b),b=g("div","checkboxContainer"),K.appendChild(b),vc=H(b,c.titleText.replace(":",""),na)[0],md=H(b,c.locationText.replace(":",""),na)[0],nd=H(b,c.descriptionText.replace(":",""),na)[0],vc.checked=!0,b=g("div","split"),K.appendChild(b),Sa=g("input",
    "previous","button"),Sa.value=c.previousText,Sa.onclick=ze,b.appendChild(Sa),Ea=g("input","next","button"),Ea.value=c.nextText,Ea.onclick=od,b.appendChild(Ea),p.body.addEventListener("mousemove",Ae),null===w&&(w=g("div"),p.body.appendChild(w),wc=g("div","title"),Yb=g("div","date"),mb=g("div","repeats"),nb=g("div","description"),ob=g("div","location"),document.body.addEventListener("mousemove",xc)),Be(),Ce());pb.innerText=c.monthNames[q.getMonth()]+", "+q.getFullYear()+" \u25be"}function qb(){var a=
    [];rb(function(d){a.push(d)});return a}function rb(a){for(var d in L)if(L.hasOwnProperty(d))for(var b in L[d])if(L[d].hasOwnProperty(b)){var e=pd(L[d][b]);if(a(e,d,b))return}}function Fa(a,d){d=h(d)?d:!0;a=a.sort(function(b,e){return b.from-e.from});d&&(a=a.sort(function(b,e){return qd(e.isAllDay)-qd(b.isAllDay)}));return a}function me(){B=g("div","header-date");x.appendChild(B);c.fullScreenModeEnabled&&(B.ondblclick=ca);r(B,"ib-arrow-left-full",c.previousMonthTooltipText,yc);r(B,"ib-pin",c.todayTooltipText,
    zc);r(B,"ib-refresh",c.refreshTooltipText,sb);r(B,"ib-search",c.searchTooltipText,rd);r(B,"ib-arrow-right-full",c.nextMonthTooltipText,Ac);c.manualEditingEnabled&&r(B,"ib-plus",c.addEventTooltipText,Ta);c.exportEventsEnabled&&(sd=r(B,"ib-arrow-down-full-line",c.exportEventsTooltipText,function(){Zb()}));r(B,"ib-eye",c.listAllEventsTooltipText,function(){td(!0)});r(B,"ib-hamburger",c.listWeekEventsTooltipText,function(){tb(null,!0)});c.fullScreenModeEnabled&&(Bc=r(B,"ib-arrow-expand-left-right",c.enableFullScreenTooltipText,
    ca));var a=g("div","title-container");B.appendChild(a);pb=g("span");pb.ondblclick=M;a.appendChild(pb);De(a)}function De(a){var d=new Date(1900,1,1),b=(new Date).getFullYear()-d.getFullYear()+c.extraSelectableYearsAhead;O=g("div","years-drop-down");a.appendChild(O);$b=g("div","contents custom-scroll-bars");O.appendChild($b);for(a=0;a<b;a++)Ee(d.getFullYear()),d.setFullYear(d.getFullYear()+1);pb.onclick=Fe}function Ee(a){var d=g("div");d.innerText=a.toString();d.id="year-selected-"+a.toString();$b.appendChild(d);
    d.onclick=function(){q.setFullYear(a);F(q);ac()&&(O.style.display="none")}}function pd(a){a.isAllDay&&(a.from=new Date(a.from.getFullYear(),a.from.getMonth(),a.from.getDate(),0,0),a.to=new Date(a.from.getFullYear(),a.from.getMonth(),a.from.getDate(),23,59));return a}function Fe(a){if("block"!==O.style.display){xa();M(a);a=O.getElementsByClassName("current-year-selected");if(1<=a.length)for(var d=a.length,b=0;b<d;b++)a[b].removeAttribute("class");a=ya("year-selected-"+q.getFullYear());null!==a&&(a.className=
    "current-year-selected");O.style.display="block";$b.scrollTop=a.offsetTop-O.offsetHeight/2}}function ac(){return null!==O&&"block"===O.style.display}function ca(){Ua?ud():vd()}function vd(){!Ua&&c.fullScreenModeEnabled&&(wd=x.style.cssText,Ua=!0,x.className+=" full-screen-view",x.removeAttribute("style"),xd("ib-arrow-contract-left-right",c.disableFullScreenTooltipText))}function ud(){Ua&&c.fullScreenModeEnabled&&(Ua=!1,x.className=x.className.replace(" full-screen-view",""),x.style.cssText=wd,xd("ib-arrow-expand-left-right",
    c.enableFullScreenTooltipText))}function xd(a,d){Bc.className=a;Cc.className=a;Dc.className=a;Ec.className=a;J(Bc,d);J(Cc,d);J(Dc,d);J(Ec,d)}function xa(){Fc()&&(I.style.display="none");Gc()&&(P.style.display="none");ac()&&(O.style.display="none");xc()}function ne(a){Ua&&yd()&&(37===a.keyCode&&(a.ctrlKey||a.metaKey)?(a.preventDefault(),zd()):39===a.keyCode&&(a.ctrlKey||a.metaKey)?(a.preventDefault(),Ad()):70===a.keyCode&&(a.ctrlKey||a.metaKey)?(a.preventDefault(),rd()):27===a.keyCode?ca():37===a.keyCode?
    yc():39===a.keyCode?Ac():40===a.keyCode?zc():116===a.keyCode&&sb())}function ub(a,d){return a.getDate()===d.getDate()&&a.getMonth()===d.getMonth()&&a.getFullYear()===d.getFullYear()}function Hc(a,d){var b=new Date(a.getFullYear(),a.getMonth(),a.getDate());b.setHours(0,0,0,0);var e=new Date(d.getFullYear(),d.getMonth(),d.getDate());e.setHours(0,0,0,0);return b<=e}function vb(a,d){var b=null;if(h(a)){b=("0"+a.getDate()).slice(-2);var e=("0"+(a.getMonth()+1)).slice(-2);b="date"===d?a.getFullYear()+"-"+
    e+"-"+b:b+"/"+e+"/"+a.getFullYear()}return b}function Va(a){var d=("0"+a.getDate()).slice(-2),b=("0"+a.getMonth()).slice(-2);return d+"/"+b+"/"+a.getFullYear()}function bc(a){return C(a.getHours())+":"+C(a.getMinutes())}function Ic(a){return 0>a.getDay()-1?6:a.getDay()-1}function Ge(a){a=h(a)?a:new Date;var d=0===a.getDay()?7:a.getDay();d=a.getDate()-d+1;var b=d+6,e=new Date(a);a=new Date(a);e.setDate(d);e.setHours(0,0,0,0);a.setDate(b);a.setHours(23,59,59,99);return[e,a]}function Ib(a,d){return(new Date(a,
    d+1,0)).getDate()}function Bd(a){var d=c.thText;if(31===a||21===a||1===a)d=c.stText;else if(22===a||2===a)d=c.ndText;else if(23===a||3===a)d=c.rdText;return d}function Cd(a){var d=a.getHours();a=a.getMinutes();return 60*d+a}function Wa(a,d){var b=new Date(a.getFullYear(),a.getMonth(),a.getDate()),e=new Date(d.getFullYear(),d.getMonth(),d.getDate());return Math.ceil(Math.abs(e-b)/864E5)}function Dd(a){return 6===a.getDay()||0===a.getDay()}function ea(){He();Ed();for(var a=Fa(qb()),d=a.length,b=0;b<
    d;b++){var e=a[b];null!==cc(e.from)&&Ie(e);var f=Y(e.repeatEvery);0<f&&(1===f?dc(e,function(k){k.setDate(k.getDate()+1)}):2===f?dc(e,function(k){k.setDate(k.getDate()+7)}):3===f?dc(e,function(k){k.setMonth(k.getMonth()+1)}):4===f&&dc(e,function(k){k.setFullYear(k.getFullYear()+1)}))}c.exportEventsEnabled&&(sd.style.display=0===d?"none":"inline-block");Fd()}function dc(a,d){for(var b=new Date(a.from),e=Z(a.repeatEveryExcludeDays),f=Z(a.seriesIgnoreDates);b<pc;){d(b);var k=Va(b),l=!(!h(a.repeatEnds)||
    Hc(b,a.repeatEnds));-1!==e.indexOf(b.getDay())||-1!==f.indexOf(k)||l||null!==cc(b)&&Jc(b,a)}}function Ie(a){Jc(a.from,a);if(a.from.getDate()!==a.to.getDate()){var d=Wa(a.from,a.to);if(0<d)for(var b=new Date(a.from),e=0;e<d;e++)b.setDate(b.getDate()+1),null!==cc(b)&&Jc(b,a)}}function Jc(a,d){var b=cc(a);if(null!==b){var e=Xa();if(b.getElementsByClassName(e).length<c.maximumEventsPerDayDisplay||0>=c.maximumEventsPerDayDisplay){e=g("div",e);var f=d.title;c.showTimesInMainCalendarEvents&&!d.isAllDay&&
    d.from.getDate()===d.to.getDate()&&(f=wb(d.from,d.to)+": "+f);e.innerText=f;b.appendChild(e);Gd(e,d,a);ec(e,d,Kc(d,a));ub(d.from,a)&&(e.id="day-"+d.id,Lc===d.id&&(e.className+=" focused-event"));e.onmousemove=function(l){Hd(l,d)};if(c.manualEditingEnabled){var k=Va(a);e.oncontextmenu=function(l){fc(l,d,k)}}c.manualEditingEnabled&&(e.onclick=function(){oa(d)})}else Je(b,a)}}function Je(a,d){var b=a.getElementsByClassName("plus-x-events");b=0<b.length?b[0]:null;if(null===b){var e=new Date(d);b=g("div",
    "plus-x-events");b.setAttribute("events","1");b.innerText="+1 "+c.moreText;b.ondblclick=M;a.appendChild(b);b.onclick=function(){Ga(e,!0)}}else{var f=parseInt(b.getAttribute("events"))+1;b.setAttribute("events",f.toString());b.innerText="+"+f+" "+c.moreText}}function cc(a){var d=new Date(q.getFullYear(),q.getMonth(),1);var b=new Date(q);var e=new Date(q),f=null,k=0;d=Ic(d);b.setMonth(b.getMonth()+1);e.setMonth(e.getMonth()-1);a.getMonth()===b.getMonth()&&a.getFullYear()===b.getFullYear()?(b=d+Ib(q.getFullYear(),
    q.getMonth()),k=a.getDate()+b):a.getMonth()===e.getMonth()&&a.getFullYear()===e.getFullYear()?k=d-Wa(a,q)+1:a.getMonth()===q.getMonth()&&a.getFullYear()===q.getFullYear()&&(b=d,k=a.getDate()+b);0<k&&(f=ya("calendar-day-"+k));return f}function He(){for(var a=0;6>a;a++)for(var d=0;7>d;d++){var b=ya("calendar-day-"+(7*a+(d+1)));gc(b,Xa());gc(b,"plus-x-events")}}function gc(a,d){for(var b=a.getElementsByClassName(d);b[0];)b[0].parentNode.removeChild(b[0])}function Id(a,d){for(var b=a.getElementsByClassName(d),
    e=b.length,f=0;f<e;f++)b[f].className=b[f].className.replace(d,"")}function ec(a,d,b){h(b)&&b<new Date&&(a.className+=" expired");Q(d.color)?(a.style.backgroundColor=d.color,Q(d.colorText)&&(a.style.color=d.colorText),Q(d.colorBorder)&&(a.style.borderLeftColor=d.colorBorder)):d.isAllDay&&(a.className+=" all-day")}function Kc(a,d){var b=Y(a.repeatEvery),e=new Date(a.to);0<b&&(b=new Date(d),b.setHours(e.getHours(),e.getMinutes()),e=b);return e}function Xa(){return c.manualEditingEnabled?"event":"event-no-hover"}
    function le(){Ha=g("div","full-day-view");x.appendChild(Ha);var a=g("div","title-bar");Ha.appendChild(a);c.fullScreenModeEnabled&&(a.ondblclick=ca);xb=g("div","title");a.appendChild(xb);r(a,"ib-close",c.closeTooltipText,function(){hc(Ha);aa=null});c.manualEditingEnabled&&r(a,"ib-plus",c.addEventTooltipText,Ta);r(a,"ib-arrow-right-full",c.nextDayTooltipText,Ke);r(a,"ib-arrow-left-full",c.previousDayTooltipText,Le);c.exportEventsEnabled&&(Jd=r(a,"ib-arrow-down-full-line",c.exportEventsTooltipText,function(){Zb(Mc)}));
    c.fullScreenModeEnabled&&(Cc=r(a,"ib-arrow-expand-left-right",c.enableFullScreenTooltipText,ca));da=g("div","contents custom-scroll-bars");Ha.appendChild(da);Ia=g("div","content-events-all-day");da.appendChild(Ia);a=g("div","all-day-text");a.innerText=c.allDayText;Ia.appendChild(a);yb=g("div","contents-events");da.appendChild(yb);for(a=0;24>a;a++){var d=g("div","hour");yb.appendChild(d);var b=g("div","hour-text");b.innerText=C(a)+":00";d.appendChild(b);b=g("div","hour-text");b.innerText=C(a)+":30";
    d.appendChild(b)}}function Ga(a,d){d=h(d)?d:!1;xb.innerText="";aa=new Date(a);Mc=[];Ia.style.display="block";gc(da,Xa());Nc(Ha);Ja(xb,a,!1,!0,!0);var b=Kd(a),e=[];if(null!==b){var f=g("span","holiday");f.innerText=" ("+b+")";xb.appendChild(f)}rb(function(m){for(var n=Wa(m.from,m.to)+1,u=new Date(m.from),pa=0;pa<n;pa++){if(ub(u,a)){e.push(m);break}u.setDate(u.getDate()+1)}n=Y(m.repeatEvery);0<n&&(1===n?ic(m,e,a,function(D){D.setDate(D.getDate()+1)}):2===n?ic(m,e,a,function(D){D.setDate(D.getDate()+
    7)}):3===n?ic(m,e,a,function(D){D.setMonth(D.getMonth()+1)}):4===n&&ic(m,e,a,function(D){D.setFullYear(D.getFullYear()+1)}))});e=Fa(e);b=e.length;f=null;for(var k=0;k<b;k++){var l=Me(e[k],a);null===f&&(f=l)}d&&(da.scrollTop=f-da.offsetHeight/2);1>=Ia.offsetHeight&&(Ia.style.display="none");c.exportEventsEnabled&&(Jd.style.display=0===e.length?"none":"inline-block")}function ic(a,d,b,e){for(var f=new Date(a.from),k=Z(a.repeatEveryExcludeDays),l=Z(a.seriesIgnoreDates);f<b;){e(f);var m=Va(f),n=!(!h(a.repeatEnds)||
    Hc(f,a.repeatEnds));if(-1===k.indexOf(f.getDay())&&-1===l.indexOf(m)&&!n&&ub(f,b)){d.push(a);break}}}function Me(a,d){var b=g("div",Xa());a.isAllDay?Ia.appendChild(b):yb.appendChild(b);if(c.manualEditingEnabled){var e=Va(d);b.oncontextmenu=function(k){fc(k,a,e)}}ec(b,a,Kc(a,d));var f=g("div","title");f.innerText=a.title;b.appendChild(f);if(!a.isAllDay||c.showAllDayEventDetailsInFullDayView)f=g("div","date"),b.appendChild(f),a.from.getDate()===a.to.getDate()?f.innerText=a.isAllDay?c.allDayText:wb(a.from,
    a.to):jc(f,a.from,a.to),zb(a.repeatEvery)&&0<a.repeatEvery&&(f=g("div","repeats"),f.innerText=c.repeatsText.replace(":","")+" "+Ya(a.repeatEvery),b.appendChild(f)),Q(a.location)&&(f=g("div","location"),f.innerText=a.location,b.appendChild(f)),Q(a.description)&&(f=g("div","description"),f.innerText=a.description,b.appendChild(f));c.manualEditingEnabled&&(b.onclick=function(){oa(a)});f=0;a.isAllDay||(f=Ne(d,b,a));return f}function Ne(a,d,b){var e=yb.offsetHeight,f=e/1440,k=c.spacing,l=null;Mc.push(b);
    if(!b.isAllDay){l=Y(b.repeatEvery);if(ub(b.from,a)||0<l)k=f*Cd(b.from);l=ub(b.to,a)?f*Cd(b.to)-k:e;l-=2*c.spacing}d.style.top=k+"px";null!==l&&(d.style.height=l+"px");d.offsetTop+d.offsetHeight>e-c.spacing&&(d.style.height=e-d.offsetTop-3*c.spacing+"px");a=k+da.offsetHeight/2;a<=da.offsetHeight&&(a=0);return a}function Le(){aa.setDate(aa.getDate()-1);Ga(aa,!0)}function Ke(){aa.setDate(aa.getDate()+1);Ga(aa,!0)}function je(){qa=g("div","list-all-events-view");x.appendChild(qa);var a=g("div","title-bar");
    qa.appendChild(a);c.fullScreenModeEnabled&&(a.ondblclick=ca);var d=g("div","title");d.innerText=c.allEventsText;a.appendChild(d);r(a,"ib-close",c.closeTooltipText,function(){hc(qa)});c.manualEditingEnabled&&r(a,"ib-plus",c.addEventTooltipText,Ta);c.exportEventsEnabled&&(Ld=r(a,"ib-arrow-down-full-line",c.exportEventsTooltipText,function(){Zb()}));c.fullScreenModeEnabled&&(Dc=r(a,"ib-arrow-expand-left-right",c.enableFullScreenTooltipText,ca));Za=g("div","contents custom-scroll-bars");qa.appendChild(Za)}
    function td(a){a=h(a)?a:!1;Nc(qa);Za.innerHTML="";a&&(Za.scrollTop=0);a=Fa(qb());for(var d=a.length,b=0;b<d;b++){var e=a[b],f=Oe(e.from);Pe(e,f)}c.exportEventsEnabled&&(Ld.style.display=0===d?"none":"inline-block");0===d&&Md(Za,Ta)}function Pe(a,d){var b=g("div",Xa());d.appendChild(b);c.manualEditingEnabled&&(b.oncontextmenu=function(f){fc(f,a)});ec(b,a);var e=g("div","title");e.innerText=a.title;b.appendChild(e);e=g("div","date");b.appendChild(e);a.from.getDate()===a.to.getDate()?a.isAllDay?kc(e,
    a.from,null," - "+c.allDayText):kc(e,a.from,null," - "+wb(a.from,a.to)):jc(e,a.from,a.to);zb(a.repeatEvery)&&0<a.repeatEvery&&(e=g("div","repeats"),e.innerText=c.repeatsText.replace(":","")+" "+Ya(a.repeatEvery),b.appendChild(e));Q(a.location)&&(e=g("div","location"),e.innerText=a.location,b.appendChild(e));Q(a.description)&&(e=g("div","description"),e.innerText=a.description,b.appendChild(e));c.manualEditingEnabled&&(b.onclick=function(){oa(a)})}function Oe(a){var d="month-"+a.getMonth()+"-"+a.getFullYear(),
    b=ya(d),e=new Date(a);if(null===b){var f=g("div","month");Za.appendChild(f);b=g("div","header");b.innerText=c.monthNames[a.getMonth()]+" "+a.getFullYear();f.appendChild(b);a=g("div","ib-arrow-expand-left-right");a.ondblclick=M;b.appendChild(a);a.onclick=function(){hc(qa);F(e)};J(a,c.expandMonthTooltipText);b=g("div","events");b.id=d;f.appendChild(b)}return b}function ke(){Ka=g("div","list-all-week-events-view");x.appendChild(Ka);var a=g("div","title-bar");Ka.appendChild(a);c.fullScreenModeEnabled&&
    (a.ondblclick=ca);R=g("div","title");a.appendChild(R);r(a,"ib-close",c.closeTooltipText,function(){hc(Ka)});c.manualEditingEnabled&&r(a,"ib-plus",c.addEventTooltipText,Ta);r(a,"ib-arrow-right-full",c.nextWeekTooltipText,Qe);r(a,"ib-arrow-left-full",c.previousWeekTooltipText,Re);c.exportEventsEnabled&&(Nd=r(a,"ib-arrow-down-full-line",c.exportEventsTooltipText,function(){Zb($a)}));c.fullScreenModeEnabled&&(Ec=r(a,"ib-arrow-expand-left-right",c.enableFullScreenTooltipText,ca));ab=g("div","contents custom-scroll-bars");
    Ka.appendChild(ab)}function tb(a,d){d=h(d)?d:!1;Nc(Ka);ab.innerHTML="";bb={};Oc={};$a=[];ra=null===a?new Date:new Date(a);d&&(ab.scrollTop=0);var b=Ge(a),e=b[0];b=b[1];Se(e,b);Te(e,b);for(var f=Fa(qb()),k=f.length,l=0;l<k;l++){for(var m=f[l],n=Wa(m.from,m.to)+1,u=new Date(m.from),pa=!1,D=0;D<n;D++)u>=e&&u<=b&&(pa=Pc(u),Od(m,pa,u),pa=!0),u.setDate(u.getDate()+1);pa&&$a.push(m);n=Y(m.repeatEvery);u=!1;0<n&&(1===n?u=lc(m,e,b,function(S){S.setDate(S.getDate()+1)}):2===n?u=lc(m,e,b,function(S){S.setDate(S.getDate()+
    7)}):3===n?u=lc(m,e,b,function(S){S.setMonth(S.getMonth()+1)}):4===n&&(u=lc(m,e,b,function(S){S.setFullYear(S.getFullYear()+1)})));u&&!pa&&$a.push(m)}for(var Pd in bb)bb.hasOwnProperty(Pd)&&ab.appendChild(bb[Pd]);c.exportEventsEnabled&&(Nd.style.display=0===$a.length?"none":"inline-block");0===$a.length&&Md(ab,Ta)}function lc(a,d,b,e){for(var f=new Date(a.from),k=Z(a.repeatEveryExcludeDays),l=Z(a.seriesIgnoreDates),m=!1;f<b;){e(f);var n=Va(f),u=!(!h(a.repeatEnds)||Hc(f,a.repeatEnds));-1===k.indexOf(f.getDay())&&
    -1===l.indexOf(n)&&!u&&f>=d&&f<=b&&(m=Pc(f),Od(a,m,f),m=!0)}return m}function Te(a,d){R.innerHTML="";if(c.showWeekNumbersInTitles){var b=g("span"),e=c.weekText+" ",f=new Date(a.getFullYear(),0,1),k=Math.ceil(((a-f)/864E5+f.getDay()+1)/7);0<f.getDay()&&k--;b.innerText=e+k+": ";R.appendChild(b)}a.getFullYear()===d.getFullYear()?(Ja(R,a,!1,!1),b=g("span"),b.innerText=" - ",R.appendChild(b),Ja(R,d,!1,!1),b=g("span"),b.innerText=", "+a.getFullYear(),R.appendChild(b)):(Ja(R,a,!1,!0),b=g("span"),b.innerText=
    " - ",R.appendChild(b),Ja(R,d,!1,!0))}function Od(a,d,b){gc(d,"no-events-text");var e=g("div",Xa());d.appendChild(e);if(c.manualEditingEnabled){var f=Va(b);e.oncontextmenu=function(k){fc(k,a,f)}}Gd(e,a,b);ec(e,a,Kc(a,b));d=g("div","title");d.innerText=a.title;e.appendChild(d);d=g("div","date");e.appendChild(d);a.from.getDate()===a.to.getDate()?d.innerText=a.isAllDay?c.allDayText:wb(a.from,a.to):jc(d,a.from,a.to);zb(a.repeatEvery)&&0<a.repeatEvery&&(d=g("div","repeats"),d.innerText=c.repeatsText.replace(":",
    "")+" "+Ya(a.repeatEvery),e.appendChild(d));Q(a.location)&&(d=g("div","location"),d.innerText=a.location,e.appendChild(d));Q(a.description)&&(d=g("div","description"),d.innerText=a.description,e.appendChild(d));c.manualEditingEnabled&&(e.onclick=function(){oa(a)})}function Se(a,d){var b=new Date(a);do Pc(b),b.setDate(b.getDate()+1);while(b<d)}function Pc(a){var d=Ic(a),b=a.getFullYear()+a.getMonth()+d,e=null,f=new Date(a);if(bb.hasOwnProperty(b))e=Oc[b];else{var k=g("div","day");bb[b]=k;Dd(a)&&(k.className+=
    " weekend-day");Qd(k,f.getFullYear(),f.getMonth(),f.getDate());e=g("div","header");k.appendChild(e);kc(e,a,c.dayNames[d]+", ");a=g("div","ib-arrow-expand-left-right");a.ondblclick=M;e.appendChild(a);a.onclick=function(){Ga(f,!0)};J(a,c.expandDayTooltipText);e=g("div","events");k.appendChild(e);k=g("div","no-events-text");k.innerText=c.noEventsAvailableText;e.appendChild(k);Oc[b]=e}return e}function Re(){ra.setDate(ra.getDate()-7);tb(ra,!0)}function Qe(){ra.setDate(ra.getDate()+7);tb(ra,!0)}function wb(a,
    d){return Qc(a)+" "+c.toTimeText+" "+Qc(d)}function Qc(a){return C(a.getHours())+":"+C(a.getMinutes())}function jc(a,d,b){a.innerHTML="";var e=g("span");e.innerText=c.startsOnText+" ";a.appendChild(e);Ja(a,d);d=g("span");d.innerText=" "+c.andFinishesOnText+" ";a.appendChild(d);Ja(a,b)}function Ja(a,d,b,e,f){b=h(b)?b:!0;e=h(e)?e:!0;if(f=h(f)?f:!1){f=Ic(d);var k=g("span");k.innerText=c.dayNames[f]+", ";a.appendChild(k)}kc(a,d);f=g("span");f.innerText=" "+c.monthNames[d.getMonth()];a.appendChild(f);
    e&&(e=g("span"),e.innerText=" "+d.getFullYear(),a.appendChild(e));b&&(b=g("span"),b.innerText=" "+Qc(d),a.appendChild(b))}function kc(a,d,b,e){if(h(b)){var f=g("span");f.innerText=b;a.appendChild(f)}b=g("span");b.innerText=d.getDate();a.appendChild(b);c.showDayNumberOrdinals&&(b=g("sup"),b.innerText=Bd(d.getDate()),a.appendChild(b));h(e)&&(d=g("span"),d.innerText=e,a.appendChild(d))}function oc(a,d,b,e,f){var k=new Date,l=a===k.getDate()&&e===k.getFullYear()&&b===k.getMonth();d=ya("calendar-day-"+
    d);k=g("span");var m=new Date(e,b,a);d.innerHTML="";k.className=f?"day-muted":"";k.className+=l?" today":"";k.innerText=a;Dd(m)&&"cell"===d.className&&(d.className="cell weekend-day");d.oncontextmenu=function(u){mc=new Date(m);xa();M(u);Rc(u,I)};c.showDayNumberOrdinals&&(f=g("sup"),f.innerText=Bd(a),k.appendChild(f));d.appendChild(k);f=g("div","ib-arrow-top-right");d.appendChild(f);J(f,c.expandDayTooltipText);l=Kd(m);if(null!==l){var n=g("span","holiday");n.innerText=l;k.appendChild(n)}f.onclick=
    function(){Ga(m,!0)};c.manualEditingEnabled&&(d.ondblclick=function(){oa(null,m)},Qd(d,e,b,a))}function Kd(a){for(var d=null,b=[],e=c.holidays.length,f=0;f<e;f++){var k=c.holidays[f];Y(k.day)===a.getDate()&&Y(k.month)===a.getMonth()+1&&(k=t(k.title,null),null!==k&&b.push(k))}0<b.length&&(d=b.join(", "));return d}function Gd(a,d,b){if(c.dragAndDropForEventsEnabled&&c.manualEditingEnabled){var e=new Date(b);a.setAttribute("draggable",!0);a.ondragstart=function(){Rd=e;v=d}}}function Qd(a,d,b,e){c.dragAndDropForEventsEnabled&&
    c.manualEditingEnabled&&(a.ondragover=function(f){Sd(f,a)},a.ondragenter=function(f){Sd(f,a)},a.ondragleave=function(f){Td(f,a)},a.ondrop=function(f){Td(f,a);M(f);if(null!==v){f=Wa(v.from,Rd);var k=Wa(v.from,v.to),l=new Date(d,b,e,v.from.getHours(),v.from.getMinutes()),m=new Date(d,b,e,v.to.getHours(),v.to.getMinutes());0<f&&(l.setDate(l.getDate()-f),m.setDate(m.getDate()-f));0<k&&m.setDate(m.getDate()+k);Ab.updateEvent(v.id,{from:l,to:m,title:v.title,description:v.description,location:v.location,
    isAllDay:v.isAllDay,color:v.color,colorText:v.colorText,colorBorder:v.colorBorder,repeatEvery:v.repeatEvery,repeatEveryExcludeDays:v.repeatEveryExcludeDays});sb()}})}function Sd(a,d){M(a);null!==v&&-1===d.className.indexOf(" drag-over")&&(d.className+=" drag-over")}function Td(a,d){M(a);null!==v&&-1<d.className.indexOf(" drag-over")&&(d.className=d.className.replace(" drag-over",""))}function Be(){null!==I&&A(p.body,I);I=g("div","calendar-drop-down-menu");p.body.appendChild(I);c.manualEditingEnabled&&
    (Sc(I,"ib-plus-icon",c.addEventTitle,function(){oa(null,mc)}),Tc(I));Sc(I,"ib-arrow-top-right-icon",c.expandDayTooltipText,function(){Ga(mc,!0)});Tc(I);Sc(I,"ib-hamburger-icon",c.viewWeekEventsText,function(){tb(mc,!0)})}function Ce(){null!==P&&A(p.body,P);if(c.manualEditingEnabled){P=g("div","calendar-drop-down-menu");p.body.appendChild(P);var a=g("div","item");a.innerText=c.removeEventText;P.appendChild(a);a.onclick=function(){cb(p.body,T);var d=function(){A(p.body,T)},b=0<Y(sa.repeatEvery)&&null!==
    Bb;Ud(c.confirmEventRemoveTitle,c.confirmEventRemoveMessage,function(){d();h(sa.id)&&(Xb.checked||null===Bb?Ab.removeEvent(sa.id,!0):(Uc(sa.seriesIgnoreDates)?sa.seriesIgnoreDates.push(Bb):sa.seriesIgnoreDates=[Bb],ea()),ta())},d,b)};Tc(P);a=g("div","item");a.innerText=c.editEventTitle;P.appendChild(a);a.onclick=function(){oa(sa)}}}function Sc(a,d,b,e){var f=g("div","item");a.appendChild(f);a=g("div",d);f.appendChild(a);a=g("div","menu-text");a.innerText=b;f.appendChild(a);f.onclick=function(){e()}}
    function Tc(a){a.appendChild(g("div","separator"))}function fc(a,d,b){sa=d;Bb=h(b)?b:null;xa();M(a);Rc(a,P)}function Fc(){return null!==I&&"block"===I.style.display}function Gc(){return null!==P&&"block"===P.style.display}function Ta(){oa(null,aa)}function La(){Ma.disabled=Ca.checked}function Lb(){var a=!1;gb.checked&&(G.value=N.value,U.value="00:00",V.value="23:59",a=!0);G.disabled=a;U.disabled=a;V.disabled=a;a=Cb(N);var d=Cb(G);d>a||d<a?(a=!0,Ca.checked=!0):a=!1;Ca.disabled=a;Mb.disabled=a;Nb.disabled=
    a;Ob.disabled=a;Pb.disabled=a;Ma.disabled=a;La()}function oa(a,d){cb(p.body,T);if(h(a)){Na.value=c.updateText;Oa.style.display="block";Kb.innerText=c.editEventTitle;E=a;N.value=vb(a.from,N.type);U.value=bc(a.from);G.value=vb(a.to,G.type);V.value=bc(a.to);gb.checked=a.isAllDay;Ba.value=t(a.title);ib.value=t(a.description);hb.value=t(a.location);Pa.value=t(a.color,"#484848");Qa.value=t(a.colorText,"#F5F5F5");Ra.value=t(a.colorBorder,"#282828");var b=Y(a.repeatEvery);0===b?Ca.checked=!0:1===b?Mb.checked=
    !0:2===b?Nb.checked=!0:3===b?Ob.checked=!0:4===b&&(Pb.checked=!0);b=Z(a.repeatEveryExcludeDays);Qb.checked=-1<b.indexOf(1);Rb.checked=-1<b.indexOf(2);Sb.checked=-1<b.indexOf(3);Tb.checked=-1<b.indexOf(4);Ub.checked=-1<b.indexOf(5);Vb.checked=-1<b.indexOf(6);Wb.checked=-1<b.indexOf(0);Da.value=vb(a.repeatEnds,Da.type)}else{b=new Date;var e=h(d)?d:b,f=new Date;e.getDate()===f.getDate()&&e.getFullYear()===f.getFullYear()&&e.getMonth()===f.getMonth()&&(e.setHours(b.getHours()),e.setMinutes(b.getMinutes()));
    Na.value=c.addText;Oa.style.display="none";Kb.innerText=c.addEventTitle;E={};N.value=vb(e,N.type);U.value=bc(e);G.value=vb(e,G.type);V.value=bc(e);gb.checked=!1;Ba.value="";ib.value="";hb.value="";Pa.value="#484848";Qa.value="#F5F5F5";Ra.value="#282828";Ca.checked=!0;Qb.checked=!1;Rb.checked=!1;Sb.checked=!1;Tb.checked=!1;Ub.checked=!1;Vb.checked=!1;Wb.checked=!1;Da.value=null}Lb();Aa.style.display="block";jb.style.display="none";Ba.focus()}function qe(){var a=Cb(N),d=Cb(G),b=U.value.split(":"),e=
    V.value.split(":"),f=Vc(Ba.value),k=Vc(ib.value),l=Vc(hb.value),m=Cb(Da,null);2>b.length?nc(c.fromTimeErrorMessage,U):2>e.length?nc(c.toTimeErrorMessage,V):""===f?nc(c.titleErrorMessage,Ba):(Vd(a,U.value),Vd(d,V.value),d<a?nc(c.toSmallerThanFromErrorMessage,G):(qc(),b=h(E.id),a={from:a,to:d,title:f,description:k,location:l,isAllDay:gb.checked,color:E.color,colorText:E.colorText,colorBorder:E.colorBorder,repeatEveryExcludeDays:E.repeatEveryExcludeDays,repeatEnds:m},Ca.checked?a.repeatEvery=0:Mb.checked?
    a.repeatEvery=1:Nb.checked?a.repeatEvery=2:Ob.checked?a.repeatEvery=3:Pb.checked&&(a.repeatEvery=4),b||(a.organizerName=c.organizerName,a.organizerEmailAddress=c.organizerEmailAddress),b?Ab.updateEvent(E.id,a,!1):Ab.addEvent(a,!1),ea(),ta()))}function Vd(a,d){var b=0,e=0,f=d.split(":");if(2===f.length){var k=parseInt(f[0]);f=parseInt(f[1]);!isNaN(k)&&2>=k.toString().length&&(b=k);!isNaN(f)&&2>=f.toString().length&&(e=f)}a.setHours(b);a.setMinutes(e)}function Cb(a,d){var b=void 0!==d?d:new Date;if(""!==
    a.value)if("date"===a.type)b=new Date(a.value);else{var e=a.value.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);e&&(e=new Date(e[3],e[2]-1,e[1]),e instanceof Date&&!isNaN(e)&&(b=e))}return b}function qc(){Aa.style.display="none";A(p.body,T)}function re(){fa.style.display="block";var a=function(){fa.style.display="none"};Ud(c.confirmEventRemoveTitle,c.confirmEventRemoveMessage,function(){a();qc();h(E.id)&&(Ab.removeEvent(E.id,!0),ta())},a)}function nc(a,d){jb.innerText=a;jb.style.display="block";d.focus()}
    function ta(){Db(Ha)&&Ga(aa);Db(qa)&&td();Db(Ka)&&tb(ra)}function se(){dd();E.color=Pa.value;E.colorText=Qa.value;E.colorBorder=Ra.value}function dd(){ia.style.display="none";fa.style.display="none"}function oe(){ia.style.display="block";fa.style.display="block"}function te(){ed();var a=[];Qb.checked&&a.push(1);Rb.checked&&a.push(2);Sb.checked&&a.push(3);Tb.checked&&a.push(4);Ub.checked&&a.push(5);Vb.checked&&a.push(6);Wb.checked&&a.push(0);E.repeatEveryExcludeDays=a}function ed(){ja.style.display=
    "none";fa.style.display="none"}function pe(){ja.style.display="block";fa.style.display="block"}function Ud(a,d,b,e,f){f=h(f)?f:!1;ka.style.display="block";rc.innerText=a;sc.innerText=d;kb.onclick=Wd;lb.onclick=Wd;kb.addEventListener("click",b);f?(tc.style.display="block",Xb.checked=!1):(tc.style.display="none",Xb.checked=!0);Wc(e)&&lb.addEventListener("click",e)}function Wd(){ka.style.display="none"}function Zb(a){cb(p.body,T);la.style.display="block";db=a;uc.checked=!0}function jd(){A(p.body,T);
    la.style.display="none"}function ue(){jd();uc.checked?eb(db,"csv"):fd.checked?eb(db,"xml"):gd.checked?eb(db,"json"):hd.checked?eb(db,"text"):id.checked&&eb(db,"ical")}function ve(a){Eb||(Eb=!0,Xd=a.pageX-z.offsetLeft,Yd=a.pageY-z.offsetTop)}function Ae(a){Eb&&(z.style.left=a.pageX-Xd+"px",z.style.top=a.pageY-Yd+"px")}function we(){Eb&&(Eb=!1,Zd=!0)}function na(){0<ba.length&&Id(x," focused-event");Sa.disabled=!0;Ea.disabled=""===X.value;ba=[];ua=0;Lc=null}function rd(){"block"!==z.style.display&&
    (ba=[],z.style.display="block",X.value="",cd(),na());"block"!==K.style.display&&kd();X.focus()}function cd(){Zd||(z.style.left=za.innerWidth/2-z.offsetWidth/2+"px",z.style.top=za.innerHeight/2-z.offsetHeight/2+"px")}function xe(){z.style.display="none";na()}function kd(){"block"===K.style.display?(K.style.display="none",ma.className="ib-square-hollow",J(ma,c.restoreTooltipText)):(K.style.display="block",ma.className="ib-minus",J(ma,c.minimizedTooltipText))}function ze(){0<ua&&(ua--,$d(),F(ba[ua].from))}
    function ye(a){13!==a.keyCode||Ea.disabled||od()}function od(){if(0===ba.length){var a=ld.checked,d=a?X.value:X.value.toLowerCase(),b={};rb(function(f){var k=t(f.title),l=t(f.location),m=t(f.description),n=!1;a||(k=k.toLowerCase(),m=m.toLowerCase(),l=l.toLowerCase());vc.checked&&-1<k.indexOf(d)?n=!0:md.checked&&-1<l.indexOf(d)?n=!0:nd.checked&&-1<m.indexOf(d)&&(n=!0);n&&(k=f.from.getMonth()+"-"+f.from.getFullYear(),b.hasOwnProperty(k)||(ba.push(f),b[k]=!0))})}else ua++;$d();if(0<ba.length){var e=
    ba[ua];F(new Date(e.from));Ue(e)}}function Ue(a){Id(x," focused-event");var d=ya("day-"+a.id);null!==d&&(d.className+=" focused-event",Lc=a.id)}function $d(){Sa.disabled=0===ua;Ea.disabled=ua===ba.length-1||0===ba.length}function Hd(a,d,b){M(a);null!==va&&(clearTimeout(va),va=null);xc();"block"!==w.style.display&&(va=setTimeout(function(){p.body.contains(T)||ac()||Fc()||Gc()||(b=h(b)?b:"",w.className=""===b?"calendar-tooltip-event":"calendar-tooltip",""!==b?w.innerText=b:(w.innerHTML="",w.appendChild(wc),
    w.appendChild(Yb),wc.innerText=d.title,zb(d.repeatEvery)&&0<d.repeatEvery?(mb.innerText=c.repeatsText.replace(":","")+" "+Ya(d.repeatEvery),cb(w,mb)):(mb.innerText="",A(w,mb)),Q(d.location)?(ob.innerText=d.location,cb(w,ob)):(ob.innerText="",A(w,ob)),Q(d.description)?(nb.innerText=d.description,cb(w,nb)):(nb.innerText="",A(w,nb)),d.from.getDate()===d.to.getDate()?Yb.innerText=d.isAllDay?c.allDayText:wb(d.from,d.to):jc(Yb,d.from,d.to)),Rc(a,w))},c.eventTooltipDelay))}function xc(){null!==va&&(clearTimeout(va),
    va=null);ae()&&(w.style.display="none")}function ae(){return null!==va||null!==w&&"block"===w.style.display}function J(a,d){a.onmousemove=function(b){Hd(b,null,d)}}function Fd(){null===Fb&&0<c.autoRefreshTimerDelay&&(Fb=setInterval(function(){sb()},c.autoRefreshTimerDelay))}function Ed(){null!==Fb&&0<c.autoRefreshTimerDelay&&(clearTimeout(Fb),Fb=null)}function sb(){yd()&&(ta(),$c?F():ea())}function yd(){return!ae()&&!p.body.contains(T)&&!ac()&&!Fc()&&!Gc()}function Nc(a){Db(a)||(a.className+=" overlay-shown")}
    function hc(a){Db(a)&&(a.className=a.className.replace(" overlay-shown",""))}function Db(a){return-1<a.className.indexOf("overlay-shown")}function g(a,d,b){a=a.toLowerCase();var e="text"===a;Xc.hasOwnProperty(a)||(Xc[a]=e?p.createTextNode(""):p.createElement(a));a=Xc[a].cloneNode(!1);h(d)&&(a.className=d);h(b)&&(a.type=b);return a}function ya(a){fb.hasOwnProperty(a)&&null!==fb[a]||(fb[a]=p.getElementById(a));p.body.contains(fb[a])||(fb[a]=p.getElementById(a));return fb[a]}function cb(a,d){try{a.contains(d)||
    a.appendChild(d)}catch(b){console.warn(b.message)}}function A(a,d){try{a.contains(d)&&a.removeChild(d)}catch(b){console.warn(b.message)}}function M(a){a.preventDefault();a.cancelBubble=!0}function Rc(a,d){var b=a.pageX,e=a.pageY;d.style.display="block";b+d.offsetWidth>za.innerWidth?b-=d.offsetWidth:b++;e+d.offsetHeight>za.innerHeight?e-=d.offsetHeight:e++;d.style.left=b+"px";d.style.top=e+"px"}function ha(a,d){try{a.type=d}catch(b){a.type="text"}}function W(a,d,b,e){var f=g("div","radioButtonContainer");
    a.appendChild(f);a=g("label","radioButton");f.appendChild(a);f=g("input",null,"radio");f.name=b;a.appendChild(f);h(e)&&(f.onchange=e);b=g("span","check-mark");a.appendChild(b);b=g("span","text");b.innerText=d;a.appendChild(b);return f}function H(a,d,b){var e=g("div");a.appendChild(e);a=g("label","checkbox");a.innerText=d;e.appendChild(a);d=g("input",null,"checkbox");a.appendChild(d);h(b)&&(d.onchange=b);b=g("span","check-mark");a.appendChild(b);return[d,a]}function r(a,d,b,e){d=g("div",d);d.ondblclick=
    M;d.onclick=e;a.appendChild(d);J(d,b);return d}function Md(a,d){a.innerHTML="";var b=g("div","no-events-available-text");a.appendChild(b);var e=g("p");e.innerText=c.noEventsAvailableFullText;b.appendChild(e);c.manualEditingEnabled&&(e=g("div"),b.appendChild(e),e=g("span"),e.innerText=c.clickText+" ",b.appendChild(e),e=g("span","link"),e.innerText=c.hereText,e.onclick=d,b.appendChild(e),e=g("span"),e.innerText=" "+c.toAddANewEventText,b.appendChild(e))}function C(a){a=a.toString();return 1===a.length?
    "0"+a:a}function Vc(a){return a.replace(/^\s+|\s+$/g,"")}function be(){for(var a=[],d=0;32>d;d++){8!==d&&12!==d&&16!==d&&20!==d||a.push("-");var b=Math.floor(16*Math.random()).toString(16);a.push(b)}return a.join("")}function h(a){return void 0!==a&&null!==a&&""!==a}function Wc(a){return h(a)&&"function"===typeof a}function ce(a){return h(a)&&"string"===typeof a}function zb(a){return h(a)&&"number"===typeof a}function Uc(a){return h(a)&&"object"===typeof a&&a instanceof Array}function Q(a){return ce(a)&&
    ""!==a}function eb(a,d){d=h(d)?d.toLowerCase():"csv";var b="",e=[];e=h(a)?e.concat(a):qb();e=Fa(e);e=Fa(e,!1);if("csv"===d){var f=[c.idText,c.fromText,c.toText,c.isAllDayText,c.titleText,c.descriptionText,c.locationText,c.backgroundColorText,c.textColorText,c.borderColorText,c.repeatsText,c.repeatEndsText,c.repeatDaysToExcludeText,c.seriesIgnoreDatesText,c.createdText,c.organizerNameText,c.organizerEmailAddressText];b=f.length;for(var k=[],l=[],m=0;m<b;m++)k.push(y(f[m]));l.push(k.join(","));f=e.length;
    for(b=0;b<f;b++){k=l;m=e[b];var n=[];n.push(y(t(m.id)));n.push(y(Gb(m.from)));n.push(y(Gb(m.to)));n.push(y(m.isAllDay?c.yesText:c.noText));n.push(y(t(m.title)));n.push(y(t(m.description)));n.push(y(t(m.location)));n.push(y(t(m.color)));n.push(y(t(m.colorText)));n.push(y(t(m.colorBorder)));n.push(y(Ya(m.repeatEvery)));n.push(y(Gb(m.repeatEnds)));n.push(y(de(m.repeatEveryExcludeDays)));n.push(y(Z(m.seriesIgnoreDates).join(",")));n.push(y(Gb(m.created)));n.push(y(t(m.organizerName)));n.push(y(t(m.organizerEmailAddress)));
    k.push(n.join(","))}b=l.join("\n")}else if("xml"===d){f=[];f.push('<?xml version="1.0" ?>');f.push("<Events>");b=e.length;for(k=0;k<b;k++){m=e[k];f.push("<Event>");for(l in m)m.hasOwnProperty(l)&&null!==m[l]&&(n=ee(l),f.push("<"+n+">"+Yc(l,m[l])+"</"+n+">"));f.push("</Event>")}f.push("</Events>");b=f.join("\n")}else if("json"===d){l=[];l.push("{");l.push('"events:": [');b=e.length;for(k=0;k<b;k++){m=e[k];l.push("{");for(f in m)m.hasOwnProperty(f)&&null!==m[f]&&l.push('"'+f+'":"'+Yc(f,m[f])+'",');
    m=l[l.length-1];l[l.length-1]=m.substring(0,m.length-1);l.push("},")}l[l.length-1]="}";l.push("]");l.push("}");b=l.join("\n")}else if("text"===d){l=[];f=e.length;for(b=0;b<f;b++){m=e[b];for(k in m)m.hasOwnProperty(k)&&null!==m[k]&&l.push(ee(k)+": "+Yc(k,m[k]));l.push("")}l.pop();b=l.join("\n")}else if("ical"===d){l=[];l.push("BEGIN:VCALENDAR");l.push("VERSION:2.0");l.push("PRODID:-//hacksw/handcal//NONSGML v1.0//EN");f=e.length;for(b=0;b<f;b++)k=e[b],l.push("BEGIN:VEVENT"),l.push("UID:"+t(k.id)),
    l.push("DTSTAMP:"+Zc(k.created)),l.push("ORGANIZER;CN="+t(k.organizerName)+":MAILTO:"+t(k.organizerEmailAddress)),l.push("DTSTART:"+Zc(k.from)),l.push("DTEND:"+Zc(k.to)),l.push("SUMMARY:"+t(k.title)),l.push("END:VEVENT");l.push("END:VCALENDAR");b=l.join("\n")}""!==b&&(e=g("a"),l="text",f=k=d,"text"===d?(k="plain",f="txt"):"ical"===d?(k="calendar",f="ics"):"json"===d&&(l="application"),e.style.display="none",e.setAttribute("target","_blank"),e.setAttribute("href","data:"+l+"/"+k+";charset=utf-8,"+
    encodeURIComponent(b)),l=e.setAttribute,k=new Date,b=C(k.getDate())+"-"+C(k.getMonth())+"-"+k.getFullYear(),k=C(k.getHours())+"-"+C(k.getMinutes()),l.call(e,"download",c.exportStartFilename+b+"_"+k+"."+f),p.body.appendChild(e),e.click(),p.body.removeChild(e),wa("onEventsExported"))}function Gb(a){var d=c.repeatsNever;h(a)&&(d=C(a.getDate())+"/"+C(a.getMonth())+"/"+a.getFullYear(),a=C(a.getHours())+":"+C(a.getMinutes()),d=d+" "+a);return d}function t(a,d){d=h(d)?d:"";return ce(a)?a:d}function Y(a,
    d){d=h(d)?d:0;return zb(a)?a:d}function qd(a,d){d=h(d)?d:0;return h(a)&&"boolean"===typeof a?a?1:0:d}function Z(a,d){d=h(d)?d:[];return Uc(a)?a:d}function Ya(a){var d=c.repeatsNever;a=Y(a);1===a?d=c.repeatsEveryDayText:2===a?d=c.repeatsEveryWeekText:3===a?d=c.repeatsEveryMonthText:4===a&&(d=c.repeatsEveryYearText);return d}function ee(a){return a.charAt(0).toUpperCase()+a.slice(1)}function Yc(a,d){var b=t(d);"boolean"===typeof d?b=d?c.yesText:c.noText:"object"===typeof d&&d instanceof Date?b=Gb(d):
    "object"===typeof d&&d instanceof Array?b="repeatEveryExcludeDays"===a?de(d):Z(d).join(","):"number"===typeof d&&(b="repeatEvery"===a?Ya(d):d.toString());return b}function Zc(a){var d=[];d.push(a.getFullYear());d.push(a.getMonth());d.push(a.getDate());d.push("T");d.push(a.getHours());d.push(a.getMinutes());d.push("00Z");return d.join("")}function de(a){var d=[];if(Uc(a))for(var b=a.length,e=0;e<b;e++){var f=a[e]-1;-1===f&&(f=6);d.push(c.dayNames[f])}return Z(d).join(",")}function y(a){a=a.replace(/(\r\n|\n|\r)/gm,
    "").replace(/(\s\s)/gm," ");a=a.replace(/"/g,'""');return'"'+a+'"'}function yc(){var a=new Date(q);a.setMonth(a.getMonth()-1);F(a);wa("onPreviousMonth")}function Ac(){var a=new Date(q);a.setMonth(a.getMonth()+1);F(a);wa("onNextMonth")}function zd(){var a=new Date(q);a.setFullYear(a.getFullYear()-1);F(a);wa("onPreviousYear")}function Ad(){var a=new Date(q);a.setFullYear(a.getFullYear()+1);F(a);wa("onNextYear")}function zc(){var a=new Date;if(q.getMonth()!==a.getMonth()||q.getFullYear()!==a.getFullYear())F(),
    wa("onToday")}function fe(a){h(a)&&"object"===typeof a||(a={});return a}function wa(a){if(null!==c&&Wc(c[a]))c[a]()}function Hb(a,d){if(null!==c&&Wc(c[a]))c[a](d)}var c={},Ab=this,q=null,pc=null,Xc={},fb={},p=null,za=null,ad=null,Jb=!1,bd=!1,L={},Fb=null,Rd=null,v=null,wd=null,Ua=!1,$c=!1,x=null,B=null,pb=null,O=null,$b=null,sd=null,Bc=null,T=null,Aa=null,fa=null,Kb=null,N=null,U=null,G=null,V=null,gb=null,Ba=null,ib=null,hb=null,Ca=null,Mb=null,Nb=null,Ob=null,Pb=null,Ma=null,jb=null,E={},Na=null,
    Oa=null,ia=null,Pa=null,Qa=null,Ra=null,ja=null,Qb=null,Rb=null,Sb=null,Tb=null,Ub=null,Vb=null,Wb=null,Da=null,Ha=null,xb=null,da=null,Ia=null,yb=null,aa=null,Mc=[],Jd=null,Cc=null,qa=null,Ld=null,Dc=null,Za=null,Ka=null,R=null,Nd=null,Ec=null,ab=null,bb={},Oc={},$a=[],ra=null,ka=null,rc=null,sc=null,Xb=null,tc=null,kb=null,lb=null,la=null,uc=null,fd=null,gd=null,hd=null,id=null,db=null,w=null,wc=null,Yb=null,mb=null,nb=null,ob=null,va=null,I=null,mc=null,P=null,sa=null,Bb=null,z=null,ma=null,K=
    null,X=null,ld=null,vc=null,md=null,nd=null,Sa=null,Ea=null,Eb=!1,Zd=!1,Xd=0,Yd=0,ba=[],ua=0,Lc=null;this.turnOnFullScreen=function(){vd()};this.turnOffFullScreen=function(){ud()};this.startTheAutoRefreshTimer=function(){Fd()};this.stopTheAutoRefreshTimer=function(){Ed()};this.moveToPreviousMonth=function(){yc()};this.moveToNextMonth=function(){Ac()};this.moveToPreviousYear=function(){zd()};this.moveToNextYear=function(){Ad()};this.moveToToday=function(){zc()};this.getCurrentDisplayDate=function(){return new Date(q)};
    this.setCurrentDisplayDate=function(a){F(new Date(a));wa("onSetDate")};this.exportAllEvents=function(a){c.exportEventsEnabled&&(a=h(a)?a:"csv",eb(null,a))};this.refresh=function(){sb()};this.setEvents=function(a,d,b){b=h(b)?b:!0;L={};this.addEvents(a,d,!1);b&&Hb("onEventsSet",a)};this.addEvents=function(a,d,b){d=h(d)?d:!0;b=h(b)?b:!0;for(var e=a.length,f=0;f<e;f++)this.addEvent(a[f],!1,!1);b&&Hb("onEventAdded",a);d&&(ea(),ta())};this.addEvent=function(a,d,b){var e=!1;if(a.from<=a.to){var f=a.from;
    f=f.getFullYear()+"-"+f.getMonth()+"-"+f.getDate();var k=be();L.hasOwnProperty(f)||(L[f]={});L[f].hasOwnProperty(k)||(d=h(d)?d:!0,b=h(b)?b:!0,h(a.id)?k=a.id:a.id=k,h(a.created)||(a.created=new Date),L[f][k]=pd(a),e=!0,b&&Hb("onEventAdded",a),d&&(ea(),ta()))}return e};this.updateEvent=function(a,d,b,e){if(a=this.removeEvent(a,!1,!1))b=h(b)?b:!0,e=h(e)?e:!0,d.id=be(),(a=this.addEvent(d,b,!1))&&e&&Hb("onEventUpdated",d);return a};this.removeEvent=function(a,d,b){var e=!1;rb(function(f,k,l){if(l===a)return d=
    h(d)?d:!0,b=h(b)?b:!0,delete L[k][l],e=!0,b&&Hb("onEventRemoved",f),d&&(ea(),ta()),!0});return e};this.clearEvents=function(a){a=h(a)?a:!0;L={};wa("onEventsCleared");a&&(ea(),ta())};this.getEvents=function(){return Fa(qb())};this.getEvent=function(a){var d=null;rb(function(b,e,f){if(f===a)return d=b,!0});return d};this.setOptions=function(a){a=fe(a);for(var d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);Jb&&(Jb=!1,F(q,!0))};(function(a,d){p=a;za=d;ad=ge;c=fe(he);h(c.previousMonthTooltipText)||(c.previousMonthTooltipText=
    "Previous Month");h(c.nextMonthTooltipText)||(c.nextMonthTooltipText="Next Month");h(c.previousDayTooltipText)||(c.previousDayTooltipText="Previous Day");h(c.nextDayTooltipText)||(c.nextDayTooltipText="Next Day");h(c.previousWeekTooltipText)||(c.previousWeekTooltipText="Previous Week");h(c.nextWeekTooltipText)||(c.nextWeekTooltipText="Next Week");h(c.addEventTooltipText)||(c.addEventTooltipText="Add Event");h(c.closeTooltipText)||(c.closeTooltipText="Close");h(c.exportEventsTooltipText)||(c.exportEventsTooltipText=
    "Export Events");h(c.todayTooltipText)||(c.todayTooltipText="Today");h(c.refreshTooltipText)||(c.refreshTooltipText="Refresh");h(c.searchTooltipText)||(c.searchTooltipText="Search");h(c.expandDayTooltipText)||(c.expandDayTooltipText="Expand Day");h(c.listAllEventsTooltipText)||(c.listAllEventsTooltipText="View All Events");h(c.listWeekEventsTooltipText)||(c.listWeekEventsTooltipText="View Current Week Events");h(c.dayHeaderNames)||(c.dayHeaderNames="Mon Tue Wed Thu Fri Sat Sun".split(" "));h(c.dayNames)||
    (c.dayNames="Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "));h(c.fromText)||(c.fromText="From:");h(c.toText)||(c.toText="To:");h(c.isAllDayText)||(c.isAllDayText="Is All-Day");h(c.titleText)||(c.titleText="Title:");h(c.descriptionText)||(c.descriptionText="Description:");h(c.locationText)||(c.locationText="Location:");h(c.addText)||(c.addText="Add");h(c.updateText)||(c.updateText="Update");h(c.cancelText)||(c.cancelText="Cancel");h(c.removeEventText)||(c.removeEventText="Remove");
    h(c.addEventTitle)||(c.addEventTitle="Add Event");h(c.editEventTitle)||(c.editEventTitle="Edit Event");h(c.monthNames)||(c.monthNames="January February March April May June July August September October November December".split(" "));h(c.showDayNumberOrdinals)||(c.showDayNumberOrdinals=!0);h(c.dragAndDropForEventsEnabled)||(c.dragAndDropForEventsEnabled=!0);h(c.exportStartFilename)||(c.exportStartFilename="exported_events_");h(c.fromTimeErrorMessage)||(c.fromTimeErrorMessage="Please select a valid 'From' time.");
    h(c.toTimeErrorMessage)||(c.toTimeErrorMessage="Please select a valid 'To' time.");h(c.toSmallerThanFromErrorMessage)||(c.toSmallerThanFromErrorMessage="Please select a 'To' date that is larger than the 'From' date.");h(c.titleErrorMessage)||(c.titleErrorMessage="Please enter a value in the 'Title' field (no empty space).");h(c.stText)||(c.stText="st");h(c.ndText)||(c.ndText="nd");h(c.rdText)||(c.rdText="rd");h(c.thText)||(c.thText="th");h(c.maximumEventsPerDayDisplay)||(c.maximumEventsPerDayDisplay=
    3);h(c.yesText)||(c.yesText="Yes");h(c.noText)||(c.noText="No");h(c.extraSelectableYearsAhead)||(c.extraSelectableYearsAhead=51);h(c.allDayText)||(c.allDayText="All-Day");h(c.allEventsText)||(c.allEventsText="All Events");h(c.exportEventsEnabled)||(c.exportEventsEnabled=!0);h(c.manualEditingEnabled)||(c.manualEditingEnabled=!0);h(c.showTimesInMainCalendarEvents)||(c.showTimesInMainCalendarEvents=!1);h(c.startsOnText)||(c.startsOnText="Starts on the");h(c.andFinishesOnText)||(c.andFinishesOnText="and finishes on the");
    h(c.toTimeText)||(c.toTimeText="to");h(c.autoRefreshTimerDelay)||(c.autoRefreshTimerDelay=3E4);h(c.confirmEventRemoveTitle)||(c.confirmEventRemoveTitle="Confirm Event Removal");h(c.confirmEventRemoveMessage)||(c.confirmEventRemoveMessage="Removing this event cannot be undone.  Do you want to continue?");h(c.okText)||(c.okText="OK");h(c.selectExportTypeTitle)||(c.selectExportTypeTitle="Select Export Type");h(c.fullScreenModeEnabled)||(c.fullScreenModeEnabled=!0);h(c.eventTooltipDelay)||(c.eventTooltipDelay=
    1E3);h(c.selectColorsText)||(c.selectColorsText="Select Colors");h(c.backgroundColorText)||(c.backgroundColorText="Background Color:");h(c.textColorText)||(c.textColorText="Text Color:");h(c.borderColorText)||(c.borderColorText="Border Color:");h(c.searchEventsTitle)||(c.searchEventsTitle="Search Events");h(c.forText)||(c.forText="For:");h(c.previousText)||(c.previousText="Previous");h(c.nextText)||(c.nextText="Next");h(c.matchCaseText)||(c.matchCaseText="Match Case");h(c.minimumDayHeight)||(c.minimumDayHeight=
    0);h(c.repeatsText)||(c.repeatsText="Repeats:");h(c.repeatDaysToExcludeText)||(c.repeatDaysToExcludeText="Repeat Days To Exclude:");h(c.daysToExcludeText)||(c.daysToExcludeText="Days To Exclude:");h(c.seriesIgnoreDatesText)||(c.seriesIgnoreDatesText="Series Ignore Dates:");h(c.repeatsNever)||(c.repeatsNever="Never");h(c.repeatsEveryDayText)||(c.repeatsEveryDayText="Every Day");h(c.repeatsEveryWeekText)||(c.repeatsEveryWeekText="Every Week");h(c.repeatsEveryMonthText)||(c.repeatsEveryMonthText="Every Month");
    h(c.repeatsEveryYearText)||(c.repeatsEveryYearText="Every Year");h(c.repeatOptionsTitle)||(c.repeatOptionsTitle="Repeat Options");h(c.moreText)||(c.moreText="More");h(c.includeText)||(c.includeText="Include:");h(c.holidays)||(c.holidays=[{day:24,month:12,title:"Christmas Eve"},{day:25,month:12,title:"Christmas Day"},{day:26,month:12,title:"Boxing Day"},{day:31,month:12,title:"New Year's Eve"},{day:1,month:1,title:"New Year's Day"}]);h(c.minimizedTooltipText)||(c.minimizedTooltipText="Minimize");h(c.restoreTooltipText)||
    (c.restoreTooltipText="Restore");h(c.removeAllEventsInSeriesText)||(c.removeAllEventsInSeriesText="Remove All Events In Series");h(c.createdText)||(c.createdText="Created:");h(c.organizerName)||(c.organizerName="");h(c.organizerEmailAddress)||(c.organizerEmailAddress="");h(c.organizerNameText)||(c.organizerNameText="Organizer:");h(c.organizerEmailAddressText)||(c.organizerEmailAddressText="Organizer Email:");h(c.enableFullScreenTooltipText)||(c.enableFullScreenTooltipText="Turn On Full-Screen Mode");
    h(c.disableFullScreenTooltipText)||(c.disableFullScreenTooltipText="Turn Off Full-Screen Mode");h(c.idText)||(c.idText="ID:");h(c.spacing)||(c.spacing=10);h(c.expandMonthTooltipText)||(c.expandMonthTooltipText="Expand Month");h(c.repeatEndsText)||(c.repeatEndsText="Repeat Ends:");h(c.noEventsAvailableText)||(c.noEventsAvailableText="No events available");h(c.viewWeekEventsText)||(c.viewWeekEventsText="View Week Events");h(c.noEventsAvailableFullText)||(c.noEventsAvailableFullText="There are no events available to view.");
    h(c.clickText)||(c.clickText="Click");h(c.hereText)||(c.hereText="here");h(c.toAddANewEventText)||(c.toAddANewEventText="to add a new event.");h(c.showAllDayEventDetailsInFullDayView)||(c.showAllDayEventDetailsInFullDayView=!1);h(c.showWeekNumbersInTitles)||(c.showWeekNumbersInTitles=!1);h(c.weekText)||(c.weekText="Week");F(ie,!0)})(document,window)};